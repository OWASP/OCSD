## Module 4: Input Validation and Output Encoding  

##### Input Validation Principles

- What is input validation and when should it be applied

- addressing input validation 
    for databases
    for operating system
    for LDAP
    etc

- client side validation versus server side validation
    This includes URL parameters, HTTP headers, cookies, file uploads, and data from APIs.

- use trusted validation library

allowlist versus deny list

* Enforce strict data constraints.

* Reject invalid input early.

	- If input fails validation, reject it immediately and provide a generic error message. Do not process it further.

* Use a trusted validation library.

	- Avoid writing your own validation logic from scratch. Use a well-tested library from your chosen framework.



##### Output Encoding and Sanitization

* Encode all user-supplied data before rendering it.

	- This prevents the browser from interpreting the data as code.

* Use context-specific encoding.

	- For HTML: Convert special characters like <, >, \&, ", and ' to their HTML entity equivalents (\&lt;, \&gt;, \&amp;, etc.). This prevents XSS attacks.

	- For JavaScript: Escape all user input if it's being placed inside a script block.

	- For SQL: The most secure method is to use parameterized queries. If this is not an option, use the database driver's specific escape function, but this is a last resort.

* Sanitize data for rich content

	- If you allow users to input rich HTML, use a dedicated HTML sanitizer library to remove dangerous tags and attributes.

* Do not rely on a single encoding function for all contexts.

	- A function for HTML encoding is not safe for JavaScript, and vice-versa.

* Use a secure encoding library.

	- Modern frameworks provide built-in functions for safe encoding.



##### Preventing Injection Attacks

* SQL Injection:

	- Always use parameterized queries or prepared statements.

	- Never build a SQL query by concatenating strings with user input.

* OS Command Injection:

	- Do not pass user-supplied data to system commands.

	- If a command must be run, use a dedicated, safe API and a whitelist of allowed commands and parameters.

* XXE (XML External Entity) Injection:

	- Disable DTDs and external entities in your XML parsers by default.

* LDAP Injection:

	- Sanitize or escape all user input before it is used in an LDAP search filter.

	- Use an API that supports parameterized queries for LDAP if available.

* SSI (Server-Side Includes) Injection:

	- Disable Server-Side Includes if you don't need them.

	- If they are necessary, ensure no user input can influence the directives.

* XPath Injection:

	- Use a dedicated XPath API that handles parameters securely instead of building XPath queries with string concatenation.


