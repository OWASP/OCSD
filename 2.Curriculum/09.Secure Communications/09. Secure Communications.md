# Module 9. Secure Communications

## Learning Objectives

After completing this module, developers will be able to:

- Configure TLS 1.2 and 1.3 with appropriate cipher suites
- Implement certificate management including pinning and mTLS
- Apply HTTP Strict Transport Security (HSTS) and related browser security controls
- Secure internal service-to-service and WebSocket communications

---

## 9.1 What is Secure Communication

### Definition and Scope

- Protecting data in transit
- Authentication of communication endpoints
- Confidentiality and integrity guarantees
- Non-repudiation considerations

### Security Properties

- Encryption of data
- Message authentication
- Protection against replay attacks
- Forward secrecy

---

## 9.2 Impact of Not Having Secure Communications

### Vulnerabilities That Result from Insecure Communications

- Man-in-the-middle attacks
- Eavesdropping and data theft
- Session hijacking
- Credential theft
- Data tampering

### Business and Compliance Impact

- Regulatory violations (PCI DSS, HIPAA, GDPR)
- Reputation damage
- Data breach liability
- Loss of customer trust

---

## 9.3 TLS 1.2 and 1.3 Configuration

### TLS Version Selection

- TLS 1.3 as preferred version
- TLS 1.2 as minimum acceptable
- Deprecation of TLS 1.0 and 1.1
- SSL protocol prohibition

### Configuration Best Practices

- Strong cipher suite selection
- Proper protocol negotiation
- Session resumption security
- Renegotiation controls

---

## 9.4 Cipher Suite Selection

### Recommended Cipher Suites

- AEAD ciphers (AES-GCM, ChaCha20-Poly1305)
- ECDHE for key exchange
- RSA or ECDSA for authentication
- SHA-256 or higher for hashing

### Cipher Suites to Avoid

- RC4, DES, 3DES
- MD5, SHA-1
- Export-grade ciphers
- NULL ciphers
- Anonymous key exchange

---

## 9.5 Certificate Management

### Certificate Lifecycle

- Certificate generation and CSR
- Certificate issuance and validation
- Certificate renewal procedures
- Certificate revocation (CRL, OCSP)

### Certificate Security

- Private key protection
- Key length requirements (RSA 2048+, ECDSA 256+)
- Certificate chain validation
- Wildcard certificate considerations

### Certificate Transparency

- CT log monitoring
- Detecting unauthorized certificates
- CT enforcement in browsers

---

## 9.6 Certificate Pinning

### Implementation Approaches

- Public key pinning
- Certificate pinning
- SPKI hash pinning

### Platform-Specific Implementation

- Mobile application pinning
- Browser HPKP (deprecated) considerations
- API client pinning

### Pinning Considerations

- Backup pin requirements
- Key rotation planning
- Failure mode handling
- Emergency bypass procedures

---

## 9.7 Mutual TLS (mTLS)

### Use Cases

- Service-to-service authentication
- Zero trust architectures
- API client authentication
- IoT device authentication

### Implementation

- Client certificate issuance
- Certificate validation on both ends
- Certificate-based identity extraction
- Revocation checking

---

## 9.8 Perfect Forward Secrecy (PFS)

### Importance

- Protection of past sessions
- Ephemeral key exchange
- Limiting impact of key compromise

### Implementation

- ECDHE cipher suites
- DHE cipher suites
- Key exchange parameter sizing

---

## 9.9 HTTP Strict Transport Security (HSTS)

### Implementation

- HSTS header configuration
- max-age directive settings
- includeSubDomains directive
- preload list submission

### Deployment Considerations

- Gradual rollout approach
- Mixed content resolution
- Subdomain impact assessment

---

## 9.10 Browser and Cookie Security Controls

### Secure Cookie Attributes

- Secure flag requirement
- HttpOnly flag
- SameSite attribute
- Cookie prefixes (__Secure-,__Host-)

### Related Headers

- Content-Security-Policy
- X-Content-Type-Options
- X-Frame-Options
- Referrer-Policy

---

## 9.11 Deprecated Protocols and Migration

### Deprecated Protocols

- SSL 2.0 and SSL 3.0
- TLS 1.0 and TLS 1.1
- Legacy cipher suites

### Migration Strategies

- Client compatibility assessment
- Gradual deprecation timeline
- Monitoring for legacy connections
- Communication with stakeholders

---

## 9.12 Internal Service Communication Security

### Service Mesh Security

- Sidecar proxy encryption
- mTLS between services
- Service identity management
- Traffic policies

### Internal Network Encryption

- VPN and tunneling
- Network segmentation
- East-west traffic encryption
- Key management for internal services

---

## 9.13 WebSocket Security

### Secure WebSocket (WSS)

- TLS for WebSocket connections
- Origin validation
- Authentication mechanisms
- Message validation

### WebSocket-Specific Concerns

- Connection hijacking prevention
- Rate limiting
- Input validation for messages
- Proper connection termination
